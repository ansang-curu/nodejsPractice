<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
     <link rel="stylesheet" href="/main.css">
    <title>Document</title>
</head>



<body class="grey-bg">
<%- include('nav.ejs') %>

  <div class="white-bg">
<!--  html ì¤‘ê°„ì— ìë°”ìŠ¤í¬ë¦½íŠ¸ ë¬¸ë²• ë„£ì„ë•Œ %, ê·¸ë¦¬ê³  ì£¼ì„ì— ê¸°í˜¸ì˜ëª»ë„£ìœ¼ë©´ ì—ëŸ¬ëœ¬ë‹¤  -->
      <% for(let i =0;i<posts.length;i++){ %>
    <div class="list-box">
          <h4><a href='/detail/<%= posts[i]._id %>'><%=JSON.stringify(posts[i].title)  %><a href="/edit/<%= posts[i]._id %>">âœï¸</a><span class="delete" data-id="<%= posts[i]._id %>">ğŸ—‘ï¸</span></a></h4>
          
          <p><%=JSON.stringify(posts[i].content)  %></p>
          <p>ì‘ì„±ì:<%=JSON.stringify(posts[i].name)  %></p>
        </div>
     <% } %>

<a href="/list/next/<%= posts[posts.length-1]._id %>">ë‹¤ìŒ</a>
  </div>

<script>
// document.querySelectorAll('.delete')[0].addEventListener('click',function(){
// // ì„œë²„ì— ì‚­ì œ ìš”ì²­ë‚ ë¦¬ê¸°~
// fetch('/delete?docid=<%= posts[0]._id %>',{method:'delete'})  
// console.log('<%= posts[0]._id %>')        
// })
// !!!!!!!!!!!!!ì—‘ì‹œì˜¤ìŠ¤ ì‚¬ìš©í•˜ë©´ ê²Ÿí¬ìŠ¤íŠ¸ ìš”ì²­ ë“± í¸í•¨. axios.get(/URL).then((r)=>{ console.log(r)}) ë‹¨ ë”°ë¡œì„¤ì¹˜í•„ìš”

for(i=0;i<'<%=posts.length%>';i++){
  document.querySelectorAll('.delete')[i].addEventListener('click',function(e){
  // ì„œë²„ì— ì‚­ì œ ìš”ì²­ë‚ ë¦¬ê¸°~
fetch('/delete?docid='+e.target.dataset.id,{method:'delete'}).then((r)=>r.text()).then((r)=>{e.target.parentElement.parentElement.style.display='none'   })
 
console.log('ì‹¤í–‰í•¨')

})
}

// ë°ì´í„° ì „ì†¡ë°©ë²•: ì¿¼ë¦¬ìŠ¤íŠ¸ë§, urlíŒŒë¼ë¯¸í„°, ê¸°ë³¸ í¼íƒœê·¸ ê²Ÿí¬ìŠ¤íŠ¸, ë§¤ì„œë“œ ì˜¤ë²„ë¼ì´ë“œí•´ì„œ í’‹
fetch('/URL').then((r)=>{
  if(r.status==200){
    return r.json()
  }else{
    // alert('ì—ëŸ¬ë‚¨')
  }
})
.then((result)=>{
// ì„±ê³µì‹œ ì‹¤í–‰ì½”ë“œ
}).catch((error)=>{
  // ì¸í„°ë„·ë¬¸ì œ ë“±ìœ¼ë¡œ ì‹¤íŒ¨ì‹œ ì‹¤í–‰ì½”ë“œ
  console.log(error)
})
</script>


</body>
</html>

<!--fetch('/abc,{                      //ì„œë²„ë¡œ ajaxë¡œ  ìƒˆë¡œê³ ì¹¨ì—†ì´ ê²Ÿìš”ì²­í•´ì¤Œ
  method:'post',
  headers:{
    'Content-type':'application/json'
  },
  body: JSON.stringify({a:1})
  } -->